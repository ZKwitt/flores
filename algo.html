<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Prueba Sheets</title>
</head>
<body>
  <h1>Valor en Sheets: <span id="valor"></span></h1>
  
  <input type="number" id="nuevoValor" placeholder="Nuevo valor">
  <button onclick="actualizar()">Actualizar Sheets</button>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbw0qr1c4p41HcvKmLDIy07EQFpVo3e7ZIFkwesOKUUINvmLBjZLBrdsJkv_3hL3WEfr2Q/exec"; // <-- cambia esto

    // Leer valor del sheet
    async function cargar() {
      const res = await fetch(API_URL);
      const data = await res.json();
      document.getElementById("valor").innerText = data.cantidad;
    }

    // Actualizar valor en el sheet
    async function actualizar() {
      const nuevo = document.getElementById("nuevoValor").value;
      await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({cantidad: nuevo}),
        headers: {"Content-Type": "application/json"}
      });
      cargar(); // refrescar
    }

    cargar();
  </script>
</body>
</html>
